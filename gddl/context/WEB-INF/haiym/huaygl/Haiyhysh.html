<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=GB2312">
<title>二级审核</title>
<link jwcid="@Any"  rel="stylesheet" type="text/css" href="ognl:assets.Rmis" />
<link jwcid="@Any"  rel="stylesheet" type="text/css" href="ognl:assets.extallcss" />
<script jwcid="@Any" type="text/javascript" src="ognl:assets.extbasejs"></script>
<script jwcid="@Any" type="text/javascript" src="ognl:assets.extalljs"></script>
<script jwcid="@Any" type="text/javascript" src="ognl:assets.pagingmpjs"></script>
<script jwcid="@Any" type="text/javascript" src="ognl:assets.extlangjs"></script>
<script type="text/javascript">

var gridDiv_history = "";
Ext.onReady(function(){
var url = "http://"+document.location.host+document.location.pathname;
var end = url.indexOf("/app");
url = url.substring(0,end);
Ext.BLANK_IMAGE_URL = url+'/ext/resources/images/s.gif';
<span jwcid="@Insert" raw="true" value="ognl:TreeScript"></span>
<span jwcid="@Insert" raw="true" value="ognl:GridScript"></span>
    
var Mt_e = new Ext.form.TextField({width:100,height:21,readOnly:true}); 
var Aar_e = new Ext.form.TextField({width:100,height:21,readOnly:true}); 
var Star_e = new Ext.form.TextField({width:100,height:21,readOnly:true}); 

var Mad_e = new Ext.form.TextField({width:100,height:21,readOnly:true}); 
var Aad_e = new Ext.form.TextField({width:100,height:21,readOnly:true}); 
var Vad_e = new Ext.form.TextField({width:100,height:21,readOnly:true}); 
var FCad_e = new Ext.form.TextField({width:100,height:21,readOnly:true}); 
var Qgrad_e = new Ext.form.TextField({width:100,height:21,readOnly:true}); 
var Stad_e = new Ext.form.TextField({width:100,height:21,readOnly:true});  
var Kqdt_e = new Ext.form.TextField({width:100,height:21,readOnly:true}); 
var kqq_e = new Ext.form.TextField({width:100,height:21,readOnly:true}); 

var gzjhf_e= new Ext.form.TextField({width:100,height:21,readOnly:true});
var gzjql_e=new Ext.form.TextField({width:100,height:21,readOnly:true});

var gzwhjhf_e = new Ext.form.TextField({width:100,height:21,readOnly:true}); 
var gzwhjgw_e = new Ext.form.TextField({width:100,height:21,readOnly:true}); 
var gzwhjql_e = new Ext.form.TextField({width:100,height:21,readOnly:true}); 
var gzwhjq_e = new Ext.form.TextField({width:100,height:21,readOnly:true}); 


var ValueForm = new Ext.form.FormPanel({width :bodyWidth-380, height:320, labelAlign: 'right', title: '化验平均值', labelWidth: 60,frame: true, layout : 'column',
items:[{columnWidth :.2, items:[{html:'',height:24},{html:'<div align=right valign=center style="width:90%"> 水分 M (%)</div>',height:23},{html:'<div align=right valign=center style="width:90%"> 灰分 A (%)</div>',height:22},{html:'<div align=right valign=center style="width:90%"> 挥发分 V (%)</div>',height:22},{html:'<div align=right valign=center style="width:90%"> 固定碳 FC (%)</div>',height:21},{html:'<div align=right valign=center style="width:90%"> 高位热 Qgr (MJ/kg)</div>',height:21},{html:'<div align=right valign=center style="width:90%">低位热 Qnet(MJ/kg)</div>',height:21},{html:'<div align=right valign=center style="width:90%"> 全硫 St (%)</div>',height:21},{html:'<div align=right valign=center style="width:90%"> 弹筒热值(MJ/kg)</div>',height:25}, {html:'<div align=right valign=center style="width:90%"> 氢Had (%)</div>',height:21}]},
{columnWidth :.2, items:[{html:'收到基(ar)',height:22}, Mt_e, Aar_e,{html:'<div align=center valign=center style="width:100"><hr></div>',height:24}, {html:'<div align=center valign=center style="width:100"><hr></div>',height:21},{html:'<div align=center valign=center style="width:100"><hr></div>',height:21},  Star_e,{html:'<div align=center valign=center style="width:100"><hr></div>',height:21},{html:'<div align=center valign=center style="width:100"><hr></div>',height:25},{html:'<div align=center valign=center style="width:100"><hr></div>',height:21}]},
{columnWidth :.2, items:[{html:'空气干燥基(ad)',height:22}, Mad_e, Aad_e, Vad_e, FCad_e, Qgrad_e, {html:'<div align=center valign=center style="width:100"><hr></div>',height:21}, Stad_e,Kqdt_e,kqq_e]},
{columnWidth :.2, items:[{html:'干燥基(d)',height:22},{html:'<div align=center valign=center style="width:100"><hr></div>',height:22},gzjhf_e,{html:'<div align=center valign=center style="width:100"><hr></div>',height:25},{html:'<div align=center valign=center style="width:100"><hr></div>',height:21},{html:'<div align=center valign=center style="width:100"><hr></div>',height:21},{html:'<div align=center valign=center style="width:100"><hr></div>',height:21},gzjql_e,{html:'<div align=center valign=center style="width:100"><hr></div>',height:25},{html:'<div align=center valign=center style="width:100"><hr></div>',height:21}]},
{columnWidth :.2, items:[{html:'干燥无灰基(daf)',height:22},{html:'<div align=center valign=center style="width:100"><hr></div>',height:21},{html:'<div align=center valign=center style="width:100"><hr></div>',height:21},gzwhjhf_e, {html:'<div align=center valign=center style="width:100"><hr></div>',height:24},gzwhjgw_e,{html:'<div align=center valign=center style="width:100"><hr></div>',height:22},gzwhjql_e,{html:'<div align=center valign=center style="width:100"><hr></div>',height:21},gzwhjq_e ]}],
buttons:[{text:'关闭',minwidth:75,handler:function(){Rpt_window.hide();}}]}); var Rpt_window =new Ext.Window({width:600,height:430,closable:false,modal:true,layout:'fit',items:[ValueForm]});
var Rpt_window =new Ext.Window({width:600,height:430,closable:false,modal:true,layout:'fit',items:[ValueForm]});


function ShowAvg(){
	Rpt_window.show();
	//得到数组
	var recs = gridDiv_sm.getSelections();
	var jisff=document.getElementById('SHIFJQPJ').value
	 
	if( recs.length> 0&& jisff=='算术平均' ){
		Aarsum= 0.0;
		Mtsum = 0.0;
		Starsum=0.0;
		Madsum=0.0;
		Aadsum=0.0;
		Vadsum=0.0;
		FCadsum=0.0;
		Qgradsum=0.0;
		Stadsum=0.0;
		Kqdtsum=0.0;
		kqqsum=0.0;
		gzjhfsum=0.0;
		gzjqlsum=0.0;
		gzwhjhfsum=0.0;
		gzwhjgwsum=0.0;
		gzwhjqlsum=0.0;
		gzwhjqsum=0.0;
		for(i = 0; i < recs.length; i++){
			rec = recs[i];
			Mtsum += eval(rec.get('MT')||0.0);
			Aarsum += eval(rec.get('AAR')||0.0);
			Starsum+= eval(rec.get('QNET_AR')||0.0);
			Madsum += eval(rec.get('MAD')||0.0);
			Aadsum += eval(rec.get('AAD')||0.0);
			Vadsum+= eval(rec.get('VAD')||0.0);
            FCadsum += eval(rec.get('FCAD')||0.0);
			Qgradsum += eval(rec.get('QGRAD')||0.0);
			Stadsum+= eval(rec.get('STAD')||0.0);
			Kqdtsum += eval(rec.get('QBAD')||0.0);
			kqqsum += eval(rec.get('HAD')||0.0);
			gzjhfsum+= eval(rec.get('AD')||0.0);
			gzjqlsum += eval(rec.get('STD')||0.0);
			gzwhjhfsum += eval(rec.get('VDAF')||0.0);
			gzwhjgwsum+= eval(rec.get('QGRAD_DAF')||0.0);
            gzwhjqlsum += eval(rec.get('SDAF')||0.0);
			gzwhjqsum += eval(rec.get('HDAF')||0.0);
			}
		Mtsum = Format(Mtsum/recs.length,1);
		Mt_e.setValue(Mtsum ); 
		Aarsum = Format(Aarsum/recs.length,2);
		Aar_e.setValue(Aarsum ); 
		Starsum = Format(Starsum/recs.length,3);
		Star_e.setValue(Starsum );
		Madsum = Format(Madsum/recs.length,2);
		Mad_e.setValue(Madsum ); 
		Aadsum = Format(Aadsum/recs.length,2);
		Aad_e.setValue( Aadsum );
		Vadsum = Format(Vadsum/recs.length,2);
		Vad_e.setValue( Vadsum );
		FCadsum = Format(FCadsum/recs.length,2);
		FCad_e.setValue( FCadsum );
		Qgradsum = Format(Qgradsum/recs.length,3);
		Qgrad_e.setValue(Qgradsum );
		Stadsum = Format(Stadsum/recs.length,2);
		Stad_e.setValue(Stadsum );
		Kqdtsum = Format(Kqdtsum/recs.length,2);
		Kqdt_e.setValue(Kqdtsum );
		kqqsum = Format(kqqsum/recs.length,2);
		kqq_e.setValue(kqqsum );
		gzjhfsum = Format(gzjhfsum/recs.length,2);
		gzjhf_e.setValue(gzjhfsum );
		gzjqlsum = Format(gzjqlsum/recs.length,2);
		gzjql_e.setValue(gzjqlsum );
		gzwhjhfsum = Format(gzwhjhfsum/recs.length,2);
		gzwhjhf_e.setValue(gzwhjhfsum );
		gzwhjgwsum = Format(gzwhjgwsum/recs.length,3);
		gzwhjgw_e.setValue(gzwhjgwsum );
		gzwhjqlsum = Format(gzwhjqlsum/recs.length,2);
		gzwhjql_e.setValue(gzwhjqlsum );
		gzwhjqsum = Format(gzwhjqsum/recs.length,2);
		gzwhjq_e.setValue(gzwhjqsum );
      }else if(recs.length> 0&& jisff=='加权平均'){
        Shulsum=0.0;
        Aarsum= 0.0;
		Mtsum = 0.0;
		Starsum=0.0;
		Madsum=0.0;
		Aadsum=0.0;
		Vadsum=0.0;
		FCadsum=0.0;
		Qgradsum=0.0;
		Stadsum=0.0;
		Kqdtsum=0.0;
		kqqsum=0.0;
		gzjhfsum=0.0;
		gzjqlsum=0.0;
		gzwhjhfsum=0.0;
		gzwhjgwsum=0.0;
		gzwhjqlsum=0.0;
		gzwhjqsum=0.0;
		for(i = 0; i < recs.length; i++){
			rec = recs[i];
			Shulsum +=eval(rec.get('SHUL'));
			Mtsum += eval((rec.get('MT')*rec.get('SHUL'))||0.0);
			Aarsum += eval((rec.get('AAR')*rec.get('SHUL'))||0.0);
			Starsum+= eval((rec.get('QNET_AR')*rec.get('SHUL'))||0.0);
			Madsum += eval((rec.get('MAD')*rec.get('SHUL'))||0.0);
			Aadsum += eval((rec.get('AAD')*rec.get('SHUL'))||0.0);
			Vadsum+= eval((rec.get('VAD')*rec.get('SHUL'))||0.0);
            FCadsum += eval((rec.get('FCAD')*rec.get('SHUL'))||0.0);
			Qgradsum += eval((rec.get('QGRAD')*rec.get('SHUL'))||0.0);
			Stadsum+= eval((rec.get('STAD')*rec.get('SHUL'))||0.0);
			Kqdtsum += eval((rec.get('QBAD')*rec.get('SHUL'))||0.0);
			kqqsum += eval((rec.get('HAD')*rec.get('SHUL'))||0.0);
			gzjhfsum+= eval((rec.get('AD')*rec.get('SHUL'))||0.0);
			gzjqlsum += eval((rec.get('STD')*rec.get('SHUL'))||0.0);
			gzwhjhfsum += eval((rec.get('VDAF')*rec.get('SHUL'))||0.0);
			gzwhjgwsum+= eval((rec.get('QGRAD_DAF')*rec.get('SHUL'))||0.0);
            gzwhjqlsum += eval((rec.get('SDAF')*rec.get('SHUL'))||0.0);
			gzwhjqsum += eval((rec.get('HDAF')*rec.get('SHUL'))||0.0);
			}
		Mtsum = Format(Mtsum/Shulsum,1);
		Mt_e.setValue(Mtsum ); 
		Aarsum = Format(Aarsum/Shulsum,2);
		Aar_e.setValue(Aarsum ); 
		Starsum = Format(Starsum/Shulsum,3);
		Star_e.setValue(Starsum );
		Madsum = Format(Madsum/Shulsum,2);
		Mad_e.setValue(Madsum ); 
		Aadsum = Format(Aadsum/Shulsum,2);
		Aad_e.setValue( Aadsum );
		Vadsum = Format(Vadsum/Shulsum,2);
		Vad_e.setValue( Vadsum );
		FCadsum = Format(FCadsum/Shulsum,2);
		FCad_e.setValue( FCadsum );
		Qgradsum = Format(Qgradsum/Shulsum,3);
		Qgrad_e.setValue(Qgradsum );
		Stadsum = Format(Stadsum/Shulsum,2);
		Stad_e.setValue(Stadsum );
		Kqdtsum = Format(Kqdtsum/Shulsum,2);
		Kqdt_e.setValue(Kqdtsum );
		kqqsum = Format(kqqsum/Shulsum,2);
		kqq_e.setValue(kqqsum );
		gzjhfsum = Format(gzjhfsum/Shulsum,2);
		gzjhf_e.setValue(gzjhfsum );
		gzjqlsum = Format(gzjqlsum/Shulsum,2);
		gzjql_e.setValue(gzjqlsum );
		gzwhjhfsum = Format(gzwhjhfsum/Shulsum,2);
		gzwhjhf_e.setValue(gzwhjhfsum );
		gzwhjgwsum = Format(gzwhjgwsum/Shulsum,3);
		gzwhjgw_e.setValue(gzwhjgwsum );
		gzwhjqlsum = Format(gzwhjqlsum/Shulsum,2);
		gzwhjql_e.setValue(gzwhjqlsum );
		gzwhjqsum = Format(gzwhjqsum/Shulsum,2);
		gzwhjq_e.setValue(gzwhjqsum );
      }

}

function Format(value, decimalLength){
	value = Math.round(value * Math.pow(10, decimalLength));


	value = value / Math.pow(10, decimalLength);

	var v = value.toString().split(".");
	if (v[0]==""){
		v[0]="0";
	}

	if (v.length > 1) {
		var len = v[1].length;
		if (len > decimalLength) {
			v[1] = v[1].substring(0, decimalLength);
		}
		else {
			 for (var i=v[1].length; i<decimalLength; i++) {
				v[1] += "0";
			}
		}
	}
	else {
		v[1] = "";
		for (var i=v[1].length; i<decimalLength; i++) {
			v[1] += "0";
		}
	}

	if (decimalLength > 0) {
		return v[0] + "." + v[1];
	}
	else {
		return v[0];
	}	
}


});
</script>	
</head>
<body id="body" jwcid="@Body" class="bgs">
<script jwcid="@Any" type="text/javascript" src="ognl:assets.Mainjs"></script>
<span jwcid="@Insert" raw=true value="ognl:TreeHtml"/>
<form listener="ognl:listeners.submit" jwcid="@Form" delegate="ognl:beans.delegate">
<table id="tablemain" border="0" cellspacing="0" cellpadding="0"
	width="100%"  height="100%">
	<tr id="SelectData" valign=top hight="100%">
	   <td>
           
	    <div id = "gridDiv" style="height:100%;overflow:none"></div>
	    <input style="display: none"  submitOnChange="true" jwcid="WeizSelectx" id="WeizSelectx" type="text"/>
        <span id="RIQ1"  jwcid = "RIQ1" style="display:none" submitOnChange="true" readonly="true" type="text"></span>
        <span id="RIQ2"  jwcid = "RIQ2" style="display:none" submitOnChange="true" type="text"></span>
        <span  style="width:150;height:21;display:none"" jwcid="YundxxDropDown" id='YundxxDropDown'  submitOnChange="true"  type="text"/>
        <span jwcid="@Insert" raw="true" value="ognl:GridHtml"></span>
        <span jwcid="SaveButton@ZRcontrib:ImgButton" buttontype="" label="保存" style="display:none" id = "SaveButton" listener="ognl:listeners.SaveButton" ></span>
        <span jwcid="SelectButton@ZRcontrib:ImgButton" buttontype=""label="查看" style="display:none" id = "SelectButton" listener="ognl:listeners.SelectButton"></span>
        <span jwcid="AvgButton@ZRcontrib:ImgButton" buttontype="" label="查看平均值" style="display:none" id="AvgButton" listener="ognl:listeners.AvgButton"></span>
        <span jwcid="HuitButton@ZRcontrib:ImgButton" buttontype=""label="回退" style="display:none" id = "HuitButton" listener="ognl:listeners.HuitButton"></span>
        <span jwcid="RefurbishButton@ZRcontrib:ImgButton" buttontype="" label="刷新" style="display:none" id = "RefurbishButton" listener="ognl:listeners.RefurbishButton"></span>
        <span jwcid="FanhButton@ZRcontrib:ImgButton" buttontype="" label="返回" style="display:none" id = "FanhButton" listener="ognl:listeners.FanhButton"></span>
        <span id="CHANGE"  jwcid = "CHANGE" style="display:none"></span>
        <span id="SHIFJQPJ"  jwcid = "SHIFJQPJ" style="display:none"></span>
        <span id="diancTree_id"  jwcid = "TREEID" style="display:none"></span>
	   </td>
	</tr>
    
</table>
</form>
</body>

</html>